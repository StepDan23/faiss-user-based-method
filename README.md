#  Демонстрация либы Faiss на примере соревнования: [RetailHero.ai/#2](https://retailhero.ai/c/recommender_system/overview) построенная на решении от [@geffy](https://github.com/geffy)

Репозиторий содержит:
* распиливание исходных данных на шарды
* вспомогательный переиспользуемый код 
* быстрый поиск соседей в связке с faiss

## Запуск

Запускаем ноутбук и происходит магия.

P.S. данные доступны по [ссылке](https://storage.yandexcloud.net/datasouls-competitions/x5-retailhero/retailhero-uplift.zip)
Если ссылка устарела, в конфиге нужно поменять поле DATA_URL

## Вариант real time решения

Обычно для Annoy требования по queries per second и recall (см http://ann-benchmarks.com/) значительно важнее чем training time.

**Часто делается так**: на одной машине (или кластере) работает модель, которая была натренирована на "вчерашних" данных, а на другой машине по заданному расписанию тренируется новая модель на обновленных данных. На этой машине может, например, стоять GPU для более быстрого тренинга (в случае FAISS). В какой-то момент нужно безболезненно переключиться на новую модель
